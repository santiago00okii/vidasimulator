<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Tienda Ficticia Millonaria</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f0f0f0;
    margin: 0; padding: 0;
  }
  header {
    background: #d70000;
    color: white;
    text-align: center;
    padding: 20px;
    position: relative;
  }
  .menu {
    position: absolute;
    left: 10px; top: 10px;
    font-size: 30px;
    cursor: pointer;
    user-select: none;
  }
  #menuOpciones {
    display: none;
    position: absolute;
    background: white;
    border: 1px solid #ccc;
    padding: 10px;
    z-index: 10;
    left: 10px;
    top: 50px;
  }
  #presupuesto, #edad {
    background: #fff8e1;
    color: #333;
    font-size: 18px;
    padding: 10px;
    text-align: center;
  }
  .tarjeta {
    background: #1e88e5;
    color: white;
    padding: 15px;
    margin: 10px;
    border-radius: 10px;
    text-align: center;
    font-size: 18px;
  }
  .tienda {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 20px;
    padding: 20px;
  }
  .producto {
    background: white;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 10px;
    text-align: center;
    box-shadow: 0 0 5px rgba(0,0,0,0.1);
  }
  .producto img {
    width: 100px;
    height: 100px;
    object-fit: contain;
  }
  .producto h4 {
    margin: 10px 0 5px;
  }
  .producto p {
    margin: 5px 0;
    font-weight: bold;
  }
  .producto button {
    background: #4caf50;
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: 4px;
    cursor: pointer;
  }
  .juegos {
    padding: 20px;
    text-align: center;
  }
  canvas {
    background: #fff;
    display: block;
    margin: 10px auto;
    border: 1px solid #ccc;
  }
</style>
</head>
<body>
<header>
  <div class="menu" onclick="mostrarMenu()">☰</div>
  <h1>Tienda Ficticia Millonaria</h1>
  <div id="menuOpciones">
    <label for="codigo">Código secreto:</label>
    <input type="text" id="codigo" />
    <button onclick="validarCodigo()">Canjear</button>
  </div>
</header>
<div class="tarjeta">Dinero actual: $<span id="dinero">1000000</span></div>
<div id="edad">Edad: <span id="anios">6</span> años</div>
<section class="tienda" id="productos"></section>
<div class="juegos">
  <button id="btnFacil">Mini Juego Fácil (+$1000)</button>
  <button id="btnDificil">Mini Juego Difícil (+$20000)</button>
  <p id="mensajeJuego" style="font-weight:bold;"></p>
  <canvas id="juego" width="400" height="150"></canvas>
</div>

<script>
  // Variables principales
  let dinero = 1000000;
  let edad = 6;
  let ahorroAlcancia = 0;
  const dineroElemento = document.getElementById("dinero");
  const edadElemento = document.getElementById("anios");
  const contenedor = document.getElementById("productos");
  const mensajeJuego = document.getElementById("mensajeJuego");
  const menuOpciones = document.getElementById("menuOpciones");
  let juegoActivo = false;
  let dificultadJuego = false;
  let alquilerActivo = false;
  const tiempoAlquilerMs = 60000; // 1 minuto alquiler
  let edadInterval = null;

  // Productos
  const productos = [];
  // Teléfonos
  for(let i=0; i<30; i++) {
    productos.push({nombre:"iPhone 14", precio:999, imagen:"https://i.imgur.com/xZgV9sH.png"});
  }
  // Consolas
  for(let i=30; i<60; i++) {
    productos.push({nombre:"PS5", precio:499, imagen:"https://i.imgur.com/63i6v81.png"});
  }
  // Juegos
  for(let i=60; i<90; i++) {
    productos.push({nombre:"FIFA 25", precio:69, imagen:"https://i.imgur.com/xl3sfZs.png"});
  }
  // Casas
  for(let i=90; i<120; i++) {
    productos.push({nombre:"Casa Moderna", precio:800000, imagen:"https://i.imgur.com/RUd1YQ3.png"});
  }
  // Alquileres (máximo $60)
  for(let i=120; i<140; i++) {
    productos.push({nombre:"Alquiler Cuarto (1 mes)", precio:55, imagen:"https://i.imgur.com/zVdZIrT.png"});
  }
  // Carros
  for(let i=140; i<150; i++) {
    productos.push({nombre:"Carro Deportivo", precio:35000, imagen:"https://i.imgur.com/5lWxoFb.png"});
  }
  // Bicicletas
  for(let i=150; i<160; i++) {
    productos.push({nombre:"Bicicleta Montaña", precio:1500, imagen:"https://i.imgur.com/KsGlnvw.png"});
  }
  // Alcancía (solo 1)
  productos.push({nombre:"Alcancía", precio:2000, imagen:"https://i.imgur.com/fYnUkec.png"});

  // Mostrar productos en la tienda
  function mostrarProductos() {
    contenedor.innerHTML = "";
    productos.forEach((p, index) => {
      const productoHTML = `
        <div class="producto">
          <img src="${p.imagen}" alt="${p.nombre}" />
          <h4>${p.nombre}</h4>
          <p>$${p.precio.toLocaleString()} ${p.nombre.includes("Alquiler") ? '(Alquiler máximo $60)' : ''}</p>
          <button onclick="comprar(${index})">Comprar</button>
        </div>`;
      contenedor.innerHTML += productoHTML;
    });
  }

  // Actualizar dinero en pantalla
  function actualizarDinero() {
    dineroElemento.textContent = dinero.toLocaleString();
  }

  // Comprar producto
  function comprar(index) {
    if(juegoActivo){
      alert("No puedes comprar mientras juegas.");
      return;
    }
    const prod = productos[index];

    if(prod.nombre.includes("Alquiler")){
      if(alquilerActivo){
        alert("Ya tienes un alquiler activo, espera a que termine.");
        return;
      }
      if(prod.precio > 60){
        alert("El alquiler no puede costar más de $60.");
        return;
      }
    }

    if (dinero >= prod.precio) {
      dinero -= prod.precio;
      actualizarDinero();

      if(prod.nombre.includes("Alquiler")){
        alquilerActivo = true;
        alert(Alquilaste: ${prod.nombre} por $${prod.precio}. Durará 1 minuto.);
        setTimeout(() => {
          alquilerActivo = false;
          alert(Tu alquiler de ${prod.nombre} terminó.);
        }, tiempoAlquilerMs);
        return;
      }

      if (prod.nombre === "Alcancía") {
        ahorroAlcancia += prod.precio;
        if (ahorroAlcancia >= 2000000) {
          dinero += ahorroAlcancia;
          alert("¡Alcancía completa! Se te devuelve: $" + ahorroAlcancia.toLocaleString());
          ahorroAlcancia = 0;
          actualizarDinero();
        }
      }
      alert(Compraste ${prod.nombre} por $${prod.precio.toLocaleString()});
    } else {
      alert("No tienes suficiente dinero.");
    }
  }

  // Mostrar menú código oculto
  function mostrarMenu() {
    menuOpciones.style.display = menuOpciones.style.display === "block" ? "none" : "block";
  }

  // Validar código oculto
  function validarCodigo() {
    const input = document.getElementById("codigo").value.trim();
    if(input.toLowerCase() === "fc25") {
      dinero += 5000000;
      actualizarDinero();
      alert("Código aceptado. Se te han añadido $5,000,000");
      document.getElementById("codigo").value = "";
      menuOpciones.style.display = "none";
    } else {
      alert("Código incorrecto.");
    }
  }

  // Contador de edad - cada 2 minutos = 1 año
  function iniciarEdad() {
    edadInterval = setInterval(() => {
      edad++;
      edadElemento.textContent = edad;
      // Condiciones de juego según edad
      if (edad === 20) {
        if (dinero < 5000000) {
          alert("No tienes $5 millones a los 20 años. Intenta de nuevo.");
          reiniciarJuego();
        }
      }
      if (edad === 25) {
        dinero += 20000000;
        actualizarDinero();
        alert("¡Felicidades! Has pasado de 25 años, recibes $20 millones de regalo.");
      }
      if (edad > 90) {
        alert("Has llegado a los 90 años. Tu personaje ha fallecido.");
        reiniciarJuego();
      }
    }, 120000); // 2 minutos por año
  }

  // Reiniciar juego
  function reiniciarJuego() {
    dinero = 1000000;
    edad = 6;
    ahorroAlcancia = 0;
    alquilerActivo = false;
    actualizarDinero();
    edadElemento.textContent = edad;
  }

  // Mini juego dinosaurio (simplificado)
  const canvas = document.getElementById("juego");
  const ctx = canvas.getContext("2d");
  const btnFacil = document.getElementById("btnFacil");
  const btnDificil = document.getElementById("btnDificil");

  let juegoInterval, obstaculoX, dinoY, saltando, gravedad, velocidadObstaculo, puntos;

  function iniciarJuego(dificil) {
    if (juegoActivo) return;
    juegoActivo = true;
    dificultadJuego = dificil;
    mensajeJuego.textContent = "Usa barra espaciadora para saltar. El juego comienza.";
    obstaculoX = canvas.width;
    dinoY = canvas.height - 30;
    saltando = false;
    gravedad = 0;
    velocidadObstaculo = dificil ? 6 : 3;
    puntos = 0;

    function dibujar() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      // Suelo
      ctx.fillStyle = "#777";
      ctx.fillRect(0, canvas.height - 10, canvas.width, 10);
      // Dino
      ctx.fillStyle = "green";
      ctx.fillRect(50, dinoY - 20, 20, 20);
      // Obstáculo
      ctx.fillStyle = "red";
      ctx.fillRect(obstaculoX, canvas.height - 30, 20, 20);
    }

    function actualizar() {
      // Movimiento obstáculo
      obstaculoX -= velocidadObstaculo;
      if (obstaculoX < -20) {
        obstaculoX = canvas.width;
        puntos++;
        if (puntos >= 10) { // Ganas si pasas 10 obstáculos
          terminarJuego(true);
        }
      }
      // Salto dino
      if (saltando) {
        dinoY -= gravedad;
        gravedad -= 1;
        if (dinoY >= canvas.height - 30) {
          dinoY = canvas.height - 30;
          saltando = false;
          gravedad = 0;
        }
      }
      // Colisión
      if (obstaculoX < 70 && obstaculoX > 30 && dinoY >= canvas.height - 30) {
        terminarJuego(false);
      }

      dibujar();
    }

    function saltar() {
      if (!saltando) {
        saltando = true;
        gravedad = 10;
      }
    }

    function terminarJuego(ganaste) {
      clearInterval(juegoInterval);
      juegoActivo = false;
      if (ganaste) {
        let premio = dificil ? 20000 : 1000;
        dinero += premio;
        actualizarDinero();
        mensajeJuego.textContent = ¡Ganaste el mini juego! Premio: $${premio};
        alert(¡Ganaste! Has recibido $${premio.toLocaleString()});
      } else {
        mensajeJuego.textContent = "Perdiste el mini juego, inténtalo de nuevo.";
        alert("Perdiste el mini juego.");
      }
      document.removeEventListener("keydown", listenerSalto);
    }

    function listenerSalto(e) {
      if (e.code === "Space") {
        saltar();
      }
    }
    document.addEventListener("keydown", listenerSalto);
    juegoInterval = setInterval(actualizar, 30);
  }

  btnFacil.onclick = () => iniciarJuego(false);
  btnDificil.onclick = () => iniciarJuego(true);

  mostrarProductos();
  actualizarDinero();
  iniciarEdad();
</script>
</body>
</html>